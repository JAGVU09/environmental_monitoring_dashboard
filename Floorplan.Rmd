---
title: "Floorplan"
author: "James Gilbert"
date: "5/26/2022"
output: html_document
---

```{r}
library(raster)
library(png)
library(mapview)
library(leaflet)
library(terra)
library(sp)
library(leafem)
library(leafpop)
```


terra has a click function to interact with a map. This is probably what I'll need to use.

There's also addCircles and addRectangles from leaflet.
```{r}
#trying to convert to terra since rgdal will be deprecated next year.
png <- readPNG('./images/Bulk Manufacturing Area.png')

img <- brick(png)

m <- viewRGB(img, 1, 2, 3, maxpixels =  950716)

lng = c(0.17595, 0.26848, 0.57198, 0.43600)
lat = c(0.34418, 0.34528, 0.48906, 0.40600)
labels = c('302-1', '302-2', '302-7', '305-1')

graphs = list(graph1, graph2, graph3, graph4)

m@map %>% 
  addTiles() %>%
  addCircles(lng = lng, lat = lat, radius = 1400, color = "#ff0033", weight = 2, label = labels, group = 'room') %>% 
  addPopupGraphs(graphs, group = 'room')
```

```{r}
#pol<-rasterToPolygons(img)

m %>% addPolygons()

m
```

```{r}
I have 11 different colors I need to make polygons out of. 

 if (img color == R 246, G 251, B 11) {
      click(img)
    }
    else if (img color == '') {
      aseptic_surf_m@map
    }
    else {
      bulk_m@map
    }
```


```{r}
aseptic_air_png <- readPNG('./images/Asceptic Fill Suite Air.png')

aseptic_air_img <- brick(aseptic_air_png)

aseptic_air <- viewRGB(aseptic_air_img, 1, 2, 3, maxpixels =  1117363)

aseptic_air@map %>% 
  addTiles() %>%
  addCircles(lng = 0.08635, lat = 0.32595, radius = 2000, color = "#ff0033", weight = 2, label = labels, popup = TRUE) %>% 
  addPopupGraphs(list(graph), group = 'Air sites')
  
```



```{r}
aseptic_surf_png <- readPNG('./images/Asceptic Fill Suite Surface.png')

aseptic_surf_img <- brick(aseptic_surf_png)

aseptic_surf_m <- viewRGB(aseptic_surf_img, 1, 2, 3, maxpixels = 1041654)

aseptic_surf_m@map %>% 
  addTiles() %>%
  addCircles(lng = 0.08068, lat = 0.08051, radius = 2000, color = "#ff0033")

```